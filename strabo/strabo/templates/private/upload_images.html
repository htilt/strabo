{% extends "/private/base.html" %}
{% set active_page = "upload_images" %}
{% block title %}Upload Images{% endblock %}
{% block head %}
    {{ super() }}
    <link rel="stylesheet" type="text/css" href="static/private_styles/upload_tool.css">
{% endblock %}

{% block content %}
<main class="container">

  <div class="form">
    <fieldset>
      <form id="image-upload"  method="POST" action="/upload_images/post" enctype="multipart/form-data">
        <div class="row">
          <div class="form-wrapper col-lg-8">
            <legend>Upload a New Image</legend>
            
            <div class="form-group">
              <label for="title">Image Title:</label><br>
              <input class="form-control" type="text" name="title" size="15" placeholder="Untitled"><br>
            </div>
            
            <div class="form-group">
              <label for="img_description">Image Description:</label><br>
              <input class="form-control" type="text" name="img_description" size="80" placeholder="Describe the view unique to this image">
            </div>
         
            <div class="form-group">
              <label for="latitude">Latitude:</label><br>
              <input class="form-control" type="text" name="latitude" size="80" placeholder="If no value is supplied, defaults to any relevant geotags">
            </div>

            <div class="form-group">
              <label for="longitude">Longitude:</label><br>
              <input class="form-control" type="text" name="longitude" size="80" placeholder="If no value is supplied, defaults to any relevant geotags">
            </div>

            <div class="form-group">
              <label for="period">Period:</label><br>
              <input class="form-control" type="text" name="period" size="80" placeholder="Post-Restoration, Pre-Restoration">
            </div>

            <div class="form-group">
              <label for="interest_point">Interest Point:</label><br>
              <select class="form-control" name='interest_point'>
                <option selected name="ip_auto"> Select One </option>
                {% for interest_point in interest_points %}
                <option name="interest_point"> {{ interest_point.0 }} </option>
                {% endfor %}
              </select>
            </div>

            <div class="form-group">
              <label for="notes">Additional Notes:</label><br>
              <input class="form-control" type="text" name="notes" size="80">
            </div>
            
            <p></p>
            
            <input type="submit" value="Upload">
          </div>


          <div class="upload-wrapper col-lg-4">
            <input type="file" id="img-input" name="file"><br /><br />
            <img id="img-preview" src="#" alt="your image"></img>
          </div>
        
        </div>
      </form>
    </fieldset>
  </div>

    
  
  <p></p>
  <p></p>
  <div class="table">
    <table class="table-bordered" margin="10px" id="preview">
      <tr>
        <th>Thumbnail</th>
        <th>Title</th>
        <th>Image Description</th>
        <th>Creation Date/Time</th> 
        <th>Latitude</th>
        <th>Longitude</th>
        <th>Period</th>
        <th>Interest Point</th>
        <th>Notes</th>
        <th>Filename</th>
      </tr>

      {% for img in images %}
      <tr>
        <td><img src="/static/test_thumbnails/{{ img.9 }}" alt="thumbnail" style="width:100px;height:100px;"></img></td>
        <td class="image_title">{{ img.0 | default("Untitled") }}</td>
        <td class="img_description">{{ img.1 }}</td>
        <td class="created_at">{{ img.2 }}</td> 
        <td class="latitude">{{ img.3 }}</td>
        <td class="longitude">{{ img.4 }}</td>
        <td class="period">{{ img.5 }}</td>
        <td class="interest_point">{{ img.6 }}</td>
        <td class="notes">{{ img.7 }}</td>
        <td class="file_name">{{ img.8 }}</td>
      </tr>
      {% endfor %}
    </table>
  </div>
</main>
{% endblock %}

{% block footer %}
    {{ super () }}
    <script type="text/javascript">
      function readURL(input) {
        if (input.files && input.files[0]) {
          var reader = new FileReader();
          reader.onload = function (e) {
            $('#img-preview').attr('src', e.target.result);
          }
          reader.readAsDataURL(input.files[0]);
         }
      }
      $("#img-input").change(function(){
        readURL(this);
      });
    </script>
{% endblock %}